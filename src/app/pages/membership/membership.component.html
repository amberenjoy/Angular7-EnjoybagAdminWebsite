<!--
 * @Description: In User Settings Edit
 * @Author: your name
 * @Date: 2019-08-05 10:49:42
 * @LastEditTime: 2019-08-27 16:49:53
 * @LastEditors: Please set LastEditors
 -->
<section class="content">
    <h2>Membership <button (click)="uploadModal=true">Import JSON</button>
    </h2>
    <div class="header">
        <mat-form-field>
            <label for="">Search</label>
            <input matInput (keypress)="onKeyPress($event)">
        </mat-form-field>
        <button (click)="filterByUser('orders')">Sort by Orders</button>
    </div>
    <table mat-table [dataSource]="sortedData" matSort class="mat-elevation-z8 component">
        <ng-container matColumnDef="username">
            <th mat-header-cell *matHeaderCellDef>User name </th>
            <td mat-cell *matCellDef="let user"> {{user.firstname}},{{user.lastname}} </td>
        </ng-container>
        <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef>Email</th>
            <td mat-cell *matCellDef="let user"> {{user.email}} </td>
        </ng-container>
        <ng-container matColumnDef="areaCode">
            <th mat-header-cell *matHeaderCellDef>area </th>
            <td mat-cell *matCellDef="let user">{{user.areacode}} </td>
        </ng-container>
        <ng-container matColumnDef="phone">
            <th mat-header-cell *matHeaderCellDef>phone</th>
            <td mat-cell *matCellDef="let user">{{user.phone}} </td>
        </ng-container>
        <ng-container matColumnDef="level">
            <th mat-header-cell *matHeaderCellDef>level</th>
            <td mat-cell *matCellDef="let user">{{user.level.level}} </td>
        </ng-container>
        <ng-container matColumnDef="orders">
            <th mat-header-cell *matHeaderCellDef>Orders</th>
            <td mat-cell *matCellDef="let user">{{user.orders.length}} </td>
        </ng-container>
        <ng-container matColumnDef="createdAt">
            <th mat-header-cell *matHeaderCellDef>createdAt </th>
            <td mat-cell *matCellDef="let user"> {{user.createAt}} </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="openUserInfo(row._id)"></tr>
    </table>
    <div *ngIf="sortedData.length===0" class="loader-overlay">
        <span class="loader">
            <span class="loader-inner"></span>
        </span>
    </div>
</section>
<!--  *ngIf="uploadModal"  -->
<div class="modal" *ngIf="uploadModal">
    <div class="modal-bg"></div>
    <div class="modal-body">
        <div class="close" (click)="uploadModal=false"></div>

        <div class="text-center">
            <h3>Are you sure to cancel this order?</h3>
            <textarea #jsonArea></textarea>
            <button (click)="uploadModal=false">Cancel</button>
            &nbsp;
            <button class="crimson" (click)="uploadData(jsonArea.value)">Confirm</button>
        </div>
        <div class="loading-bg" *ngIf="loadingData">
            <div class="loader-inner"></div>
        </div>
    </div>
</div>